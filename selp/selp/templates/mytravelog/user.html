{% extends 'mytravelog/master/user_base.html' %}
{% load static %}

<!-- left column -->
{% block left_column_block %}
    <div class="logs-content">
        {% if authenticated_to_edit_profile %}
            <button class="btn btn-primary button-add-new" id="add-new-log-button">Add new log</button>
        {% endif %}
    </div>

    <div class="albums-content">
        {% if authenticated_to_edit_profile %}
            <button class="btn btn-primary button-add-new" id="add-new-album-button">Add new album</button>
        {% endif %}
    </div>

    <div class="followers-content"></div>

    <div class="following-content"></div>
{% endblock %}

<!-- right column -->
{% block right_column_block %}

    <div class="logs-content">
        <div class="logs-container">
            {% for log in requested_user_logs %}
                <div class="log" data-id="{{ log.id }}" data-location="{{ log.city.name }}, {{ log.city.country_name }}" data-created-at="{{ log.created_at }}">
                    <div class="header">
                        <img class="country-flag" src="{% static 'mytravelog/imgs/flags/'|add:log.city.country_url_name|add:'.jpg' %}">
                        <p class="location">{{ log.city.name }}, {{ log.city.country_name }}</p>

                        <div class="overflow-button"></div>
                        <div class="log-dropdown-container">
                            <div class="log-dropdown-menu">
                                <p class="log-dropdown-item log-dropdown-item-view">View</p>
                                <p class="log-dropdown-item log-dropdown-item-share">Share</p>
                                <p class="log-dropdown-item log-dropdown-item-edit">Edit</p>
                                <p class="log-dropdown-item log-dropdown-item-delete">Delete</p>
                            </div>
                        </div>
                    </div>

                    {% if log.pictures|length > 0 %}
                        <div class="log-pictures-container">
                            {% if log.pictures|length == 1 %}
                                <div class="log-picture log-picture-full" data-url="{{ log.pictures.0.picture.url }}" style="background-image: url('{{ log.pictures.0.picture.url }}')">
                                    <div class="mask"></div>
                                </div>
                            {% elif log.pictures|length == 2 %}
                                <div class="log-picture log-picture-left" data-url="{{ log.pictures.0.picture.url }}" style="background-image: url('{{ log.pictures.0.picture.url }}')">
                                    <div class="mask"></div>
                                </div><!--
                                --><div class="log-picture log-picture-right" data-url="{{ log.pictures.1.picture.url }}" style="background-image: url('{{ log.pictures.1.picture.url }}')">
                                <div class="mask"></div>
                            </div>
                            {% else %}
                                {% for log_picture in log.pictures %}
                                    {% if forloop.counter == 1 %}
                                        <div class="log-picture log-picture-left" data-url="{{ log_picture.picture.url }}" style="background-image: url('{{ log_picture.picture.url }}')">
                                            <div class="mask"></div>
                                        </div><!--
                                    {% elif forloop.counter == 2 %}
                                        --><div class="log-picture-right">
                                        <div class="log-picture log-picture-right-top" data-url="{{ log_picture.picture.url }}" style="background-image: url('{{ log_picture.picture.url }}')">
                                            <div class="mask"></div>
                                        </div>
                                        {% elif forloop.counter == 3 %}
                                        <div class="log-picture log-picture-right-bottom" data-url="{{ log_picture.picture.url }}" style="background-image: url('{{ log_picture.picture.url }}')">
                                            <div class="mask"></div>
                                        </div>
                                    </div>
                                    {% else %}
                                        <div class="log-picture" data-url="{{ log_picture.picture.url }}" style="display: none"></div>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                        </div>
                    {% endif %}

                    <p class="description">{{ log.description }}</p>

                    <div class="user-info-container">
                        <img class="profile-picture" src="{{ log.user_profile.profile_picture.url }}">
                        <div class="name-and-timestamp-container">
                            <p class="name">{{ log.user_profile.user.get_full_name }}</p>
                            <p class="timestamp">{{ log.created_at }}</p>
                        </div>
                    </div>

                    <div class="like-and-comment-count-container">
                        <div class="count-container">
                            <p class="title">Likes</p>
                            <p class="count">0</p>
                        </div>
                        <div class="count-container right">
                            <p class="title">Comments</p>
                            <p class="count">0</p>
                        </div>
                        <div class="liker-or-commenter-user-profile-pictures">

                        </div>
                    </div>

                    <div class="like-and-comment-container">
                        <button class="like-log-button"></button>
                        <input class="form-control comment-log-input" type="text" placeholder="Say something nice..." autocomplete="off" required="true">
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    <div class="albums-content">
        <div class="albums-container">
            <div class="row">
                {% for album in requested_user_albums %}
                    <div class="col-lg-4 custom-column">
                        <a class="album" data-id="{{ album.id }}" data-start-date="{{ album.start_date|date:'Y-m-d' }}" data-end-date="{{ album.end_date|date:'Y-m-d' }}">
                            <div class="cover-picture" style="background-image: url('{{ album.cover_picture.url }}')">
                                <div class="mask">
                                    {% if authenticated_to_edit_profile %}
                                        <div class="overflow-button"></div>
                                        <div class="album-dropdown-container">
                                            <div class="album-dropdown-menu">
                                                <p class="album-dropdown-item album-dropdown-item-edit">Edit</p>
                                                <p class="album-dropdown-item album-dropdown-item-delete">Delete</p>
                                            </div>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <p class="name">{{ album.name }}</p>
                            <p class="duration">{{ album.duration }} days</p>
                        </a>
                    </div>
                    {% if forloop.counter|divisibleby:3%}
                        </div>
                        <div class="row">
                    {% endif %}
                {% endfor %}
                </div>
        </div>
    </div>

    <div class="followers-content">
        <p>FOLLOWERS</p>
    </div>

    <div class="following-content">
        <p>FOLLOWING</p>
    </div>

{% endblock %}

<!-- all modals -->
{% block popup_block %}
    <!-- Add or Edit album modal -->
    <div class="modal fade" id="add-or-edit-album-modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title" id="add-or-edit-album-modal-title">Add new album</h4>
                </div>
                <div class="modal-body">
                    <form class="form-container form-group" id="add-or-edit-album-modal-form" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="alert alert-danger error-container" id="add-or-edit-album-modal-error-container"></div>

                        <label class="form-label" for="name">Name*</label>
                        <input class="form-control form-input" id="add-or-edit-album-modal-name-input" name="name" type="text" autofocus="" required="" placeholder="Enter the name of the album">
                        <br>
                        <label class="form-label" for="start_date">Start date*</label>
                        <input class="form-control form-input" id="add-or-edit-album-modal-start-date-input" name="start_date" type="date" min="1900-01-01" max="9000-12-31" required="">
                        <br>
                        <label class="form-label" for="end_date">End date*</label>
                        <input class="form-control form-input" id="add-or-edit-album-modal-end-date-input" name="end_date" type="date" min="1900-01-01" max="9000-12-31" required="">
                        <br>
                        <label class="form-label" for="cover_picture">Cover picture</label>
                        <input class="form-control form-input" name="cover_picture" type="file">

                    </form>
                </div>
                <div class="modal-footer">
                    <div class="modal-footer-wrapper">
                        <button type="button" class="btn btn-default button-negative" data-dismiss="modal">Close</button>
                        <button type="submit" form="add-or-edit-album-modal-form" class="btn btn-primary button-positive" id="add-or-edit-album-modal-submit-button">Add</button>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

    <!-- Delete album modal -->
    <div class="modal fade" id="delete-album-modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">Delete album</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-danger error-container" id="delete-album-modal-error-container"></div>
                    <p>Are you sure you want to delete the following album:</p>
                    <p id="delete-album-modal-album-name"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default button-negative" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-danger button-positive" id="delete-album-modal-submit-button">Delete</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

    <!-- Add log modal -->
    <div class="modal fade" id="add-log-modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title" id="add-log-modal-title">Add new log</h4>
                </div>
                <div class="modal-body">
                    <form class="form-container form-group" id="add-log-modal-form" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="alert alert-danger error-container" id="add-log-modal-error-container"></div>

                        <div id="add-log-modal-map-container"></div>

                        <label class="form-label" for="location">Current location*</label>
                        <input class="form-control form-input" id="add-log-modal-location-input" name="location" type="text" readonly placeholder="Enter the name of your current city" required="">
                        <input class="form-control form-input" id="add-log-modal-latitude-input" name="latitude" type="hidden" >
                        <input class="form-control form-input" id="add-log-modal-longitude-input" name="longitude" type="hidden">
                        <br>
                        <label class="form-label" for="album_name">Choose an album this log belongs to*</label>
                        <select class="form-control form-input" name="album_name" id="add-log-modal-album-input" required="">
                            <option value="None">None</option>
                            {% for album in requested_user_albums %}
                                <option value="{{ album.name }}">{{ album.name }}</option>
                            {% endfor %}
                        </select>
                        <br>
                        <label class="form-label" for="description">Description*</label>
                        <textarea class="form-control form-input" id="add-log-modal-description-input" placeholder="Enter a short description" name="description" required="" rows="3"></textarea>
                        <br>
                        <label class="form-label">Choose images to upload</label>
                        <div class="form-image-group" id="add-log-modal-images-container">
                        </div>
                        <div id="add-log-modal-more-images-button-wrapper">
                            <p class="add-more-images-button" id="add-log-modal-more-images-button">+ Add another image</p>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <div class="modal-footer-wrapper">
                        <button type="button" class="btn btn-default button-negative" data-dismiss="modal">Close</button>
                        <button type="submit" form="add-log-modal-form" class="btn btn-primary button-positive" id="add-log-modal-submit-button">Add</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- show log picture modal -->
    <div class="modal fade" id="log-picture-modal">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-body" id="log-picture-modal-body">
                    <div id="log-picture-modal-picture"></div>
                    <div id="log-picture-modal-footer">
                        <p id="log-picture-modal-previous-button">< Prev</p>
                        <p id="log-picture-modal-index">1 of 5</p>
                        <p id="log-picture-modal-next-button">Next ></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- delete log modal -->
    <div class="modal fade" id="delete-log-modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">Delete log</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-danger error-container" id="delete-log-modal-error-container"></div>
                    <p>Are you sure you want to delete the following log:</p>
                    <p id="delete-log-modal-paragraph">Location: <span id="delete-log-modal-location"></span></p>
                    <p id="delete-log-modal-paragraph">Created at: <span id="delete-log-modal-created-at"></span></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default button-negative" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-danger button-positive" id="delete-log-modal-submit-button">Delete</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
{% endblock %}
